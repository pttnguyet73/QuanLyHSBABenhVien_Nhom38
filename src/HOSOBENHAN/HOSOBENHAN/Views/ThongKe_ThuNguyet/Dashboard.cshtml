@{
    ViewData["Title"] = "Home Page";
}
@model  HOSOBENHAN.Models.DashboardViewModel
@using System.Text.Json
@{
    var khoaLabels = Model.CircleChart.Select(k => k.TenKhoa).ToList();
    var khoaSeries = Model.CircleChart.Select(k => k.SoBenhNhan).ToList();
    var labels = Json.Serialize(Model.ColumnChart.Labels);
    var series1 = Json.Serialize(Model.ColumnChart.Series1);
    var series2 = Json.Serialize(Model.ColumnChart.Series2);
}

@{
    var pieData = Model.PieChart.FirstOrDefault(); // lấy phần tử đầu tiên (nếu có)
    var series = new int[] { pieData?.daDieuTriXong ?? 0, pieData?.chuaDieuTriXong ?? 0 };

    var seriesJson = System.Text.Json.JsonSerializer.Serialize(series);
    
}


@section Scripts {
    <script>
        console.log("Labels:", @Html.Raw(JsonSerializer.Serialize(khoaLabels)));
        console.log("Series:", @Html.Raw(JsonSerializer.Serialize(khoaSeries)));
        console.log("SeriesJson: ", @Html.Raw(seriesJson));
    </script>
    <script>
        // ===================== Average Enrollment Rate Start ===============================
        function createChartTwo(chartId, color1, color2) {
        
            var labels = @Html.Raw(Json.Serialize(Model.MonthChart.Labels));
    var series1 = @Html.Raw(Json.Serialize(Model.MonthChart.Series1));
    var series2 = @Html.Raw(Json.Serialize(Model.MonthChart.Series2));
            var options = {
                series: [{
                    name: "series1",
                    data: series1

                }, {
                    name: "series2",
                    data: series2

                }],
                legend: {
                    show: false
                },
                chart: {
                    type: "area",
                    width: "100%",
                    height: 270,
                    toolbar: {
                        show: false
                    },
                    padding: {
                        left: 0,
                        right: 0,
                        top: 0,
                        bottom: 0
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: "smooth",
                    width: 3,
                    colors: [color1, color2], // Use two colors for the lines
                    lineCap: "round"
                },
                grid: {
                    show: true,
                    borderColor: "#D1D5DB",
                    strokeDashArray: 2,
                    position: "back",
                    xaxis: {
                        lines: {
                            show: false
                        }
                    },
                    yaxis: {
                        lines: {
                            show: true
                        }
                    },
                    row: {
                        colors: undefined,
                        opacity: 0.5
                    },
                    column: {
                        colors: undefined,
                        opacity: 0.5
                    },
                    padding: {
                        top: -20,
                        right: 0,
                        bottom: -10,
                        left: 0
                    },
                },
                fill: {
                    type: "gradient",
                    colors: [color1, color2], // Use two colors for the gradient
                    // gradient: {
                    //     shade: "light",
                    //     type: "vertical",
                    //     shadeIntensity: 0.5,
                    //     gradientToColors: [`${color1}`, `${color2}00`], // Bottom gradient colors with transparency
                    //     inverseColors: false,
                    //     opacityFrom: .6,
                    //     opacityTo: 0.3,
                    //     stops: [0, 100],
                    // },
                    gradient: {
                        shade: "light",
                        type: "vertical",
                        shadeIntensity: 0.5,
                        gradientToColors: [undefined, `${color2}00`], // Apply transparency to both colors
                        inverseColors: false,
                        opacityFrom: [0.4, 0.6], // Starting opacity for both colors
                        opacityTo: [0.3, 0.3], // Ending opacity for both colors
                        stops: [0, 100],
                    },
                },
                markers: {
                    colors: [color1, color2], // Use two colors for the markers
                    strokeWidth: 3,
                    size: 0,
                    hover: {
                        size: 10
                    }
                },
                xaxis: {
                    labels: {
                        show: false
                    },
                    categories: labels,
                    tooltip: {
                        enabled: false
                    },
                    labels: {
                        formatter: function (value) {
                            return value;
                        },
                        style: {
                            fontSize: "14px"
                        }
                    }
                },
                yaxis: {
                    labels: {
                        formatter: function (value) {
                            return  value + "k";
                        },
                        style: {
                            fontSize: "14px"
                        }
                    },
                },
                tooltip: {
                    x: {
                        format: "dd/MM/yy HH:mm"
                    }
                }
            };

            var chart = new ApexCharts(document.querySelector(`#${chartId}`), options);
            chart.render();
        }

        createChartTwo("enrollmentChart", "#487FFF", "#FF9F29");
        
  
        // ===================== Average Enrollment Rate End ===============================


        // ================================ User Activities Donut chart End ================================
        var options = {
            series: @Html.Raw(seriesJson),
            colors: ["#FF9F29", "#45B369"],
            labels: ["Đã xong", "Đang điều trị"],
            legend: {
                show: false
            },
            chart: {
                type: "donut",
                height: 260,
                sparkline: {
                    enabled: true // Remove whitespace
                },
                margin: {
                    top: 0,
                    right: 0,
                    bottom: 0,
                    left: 0
                },
                padding: {
                    top: 0,
                    right: 0,
                    bottom: 0,
                    left: 0
                }
            },
            stroke: {
                width: 0,
            },
            dataLabels: {
                enabled: false
            },
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 200
                    },
                    legend: {
                        position: "bottom"
                    }
                }
            }],
        };

        var chart = new ApexCharts(document.querySelector("#statisticsDonutChart"), options);
        chart.render();
        
        // ================================ User Activities Donut chart End ================================


        // ================================ Client Payment Status chart End ================================
        var labels1 = @Html.Raw(labels);
        var series1 = @Html.Raw(series1);
        var series2 = @Html.Raw(series2);
        var options = {
            series: [{
                name: "Net Profit",
                data: series1
            }, {
                name: "Free Cash",
                data: series2
            }],
            colors: ["#45B369", "#FF9F29"],
            labels: ["Active", "New", "Total"],

            legend: {
                show: false
            },
            chart: {
                type: "bar",
                height: 260,
                toolbar: {
                    show: false
                },
            },
            grid: {
                show: true,
                borderColor: "#D1D5DB",
                strokeDashArray: 4, // Use a number for dashed style
                position: "back",
            },
            plotOptions: {
                bar: {
                    borderRadius: 4,
                    columnWidth: 8,
                },
            },
            dataLabels: {
                enabled: false
            },
            states: {
                hover: {
                    filter: {
                        type: "none"
                    }
                }
            },
            stroke: {
                show: true,
                width: 0,
                colors: ["transparent"]
            },
            xaxis: {
                categories: labels1,
            },
            fill: {
                opacity: 1,
                width: 18,
            },
        };

        var chart = new ApexCharts(document.querySelector("#paymentStatusChart"), options);
        chart.render();
        // ================================ Client Payment Status chart End ================================

        // ================================= Multiple Radial Bar Chart Start =============================
        var labels = @Html.Raw(JsonSerializer.Serialize(khoaLabels));
        var series = @Html.Raw(JsonSerializer.Serialize(khoaSeries));
        var options = {
            series: series,
            chart: {
                height: 300,
                type: "radialBar",
            },
            colors: ["#3D7FF9", "#ff9f29", "#16a34a"],
            stroke: {
                lineCap: "round",
            },
            plotOptions: {
                radialBar: {
                    hollow: {
                        size: "10%", // Adjust this value to control the bar width
                    },
                    dataLabels: {
                        name: {
                            fontSize: "12px",
                        },
                        value: {
                            fontSize: "16px",
                        },
                      
                    },
                    track: {
                        margin: 20, // Space between the bars
                    }
                }
            },
            labels: labels,
        };

        var chart = new ApexCharts(document.querySelector("#radialMultipleBar"), options);
        chart.render();

        // ================================= Multiple Radial Bar Chart End =============================

        // ================================ Earning Statistics bar chart Start ================================
        var options = {
            series: [{
                name: "Sales",
                data: [{
                    x: 'Jan',
                    y: 85000,
                }, {
                    x: 'Feb',
                    y: 70000,
                }, {
                    x: 'Mar',
                    y: 40000,
                }, {
                    x: 'Apr',
                    y: 50000,
                }, {
                    x: 'May',
                    y: 60000,
                }, {
                    x: 'Jun',
                    y: 50000,
                }, {
                    x: 'Jul',
                    y: 40000,
                }, {
                    x: 'Aug',
                    y: 50000,
                }, {
                    x: 'Sep',
                    y: 40000,
                }, {
                    x: 'Oct',
                    y: 60000,
                }, {
                    x: 'Nov',
                    y: 30000,
                }, {
                    x: 'Dec',
                    y: 50000,
                }]
            }],
            chart: {
                type: 'bar',
                height: 310,
                toolbar: {
                    show: false
                }
            },
            plotOptions: {
                bar: {
                    borderRadius: 4,
                    horizontal: false,
                    columnWidth: '23%',
                    endingShape: 'rounded',
                }
            },
            dataLabels: {
                enabled: false
            },
            fill: {
                type: 'gradient',
                colors: ['#487FFF'], // Set the starting color (top color) here
                gradient: {
                    shade: 'light', // Gradient shading type
                    type: 'vertical',  // Gradient direction (vertical)
                    shadeIntensity: 0.5, // Intensity of the gradient shading
                    gradientToColors: ['#487FFF'], // Bottom gradient color (with transparency)
                    inverseColors: false, // Do not invert colors
                    opacityFrom: 1, // Starting opacity
                    opacityTo: 1,  // Ending opacity
                    stops: [0, 100],
                },
            },
            grid: {
                show: true,
                borderColor: '#D1D5DB',
                strokeDashArray: 4, // Use a number for dashed style
                position: 'back',
            },
            xaxis: {
                type: 'category',
                categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            },
            yaxis: {
                labels: {
                    formatter: function (value) {
                        return (value / 1000).toFixed(0) + 'k';
                    }
                }
            },
            tooltip: {
                y: {
                    formatter: function (value) {
                        return value / 1000 + 'k';
                    }
                }
            }
        };

        var chart = new ApexCharts(document.querySelector("#barChart"), options);
        chart.render();
    </script>
}

<div class="row gy-4">
    <div class="col-xxxl-9">
        <div class="row gy-4">
            <div class="col-xxl-3 col-xl-4 col-sm-6">
                <div class="card p-3 shadow-2 radius-8 h-100 bg-gradient-end-6">
                    <div class="card-body p-0">
                        <div class="d-flex flex-wrap align-items-center justify-content-between gap-1 mb-8">

                            <div class="d-flex align-items-center gap-2">
                                <span class="mb-0 w-48-px h-48-px bg-cyan-100 text-cyan-600 flex-shrink-0 text-white d-flex justify-content-center align-items-center rounded-circle h6 mb-0">
                                    <i class="ri-group-fill"></i>
                                </span>
                                <div>
                                    <h6 class="fw-semibold mb-2">@Model.soLuongChart.BacSiTheoMa</h6>
                                    <span class="fw-medium text-secondary-light text-sm">Bác sĩ (kể cả bác sĩ chính và bác sĩ xét nghiệm)</span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm mb-0"> <span class="text-cyan-600">@Model.soLuongChart.BacSiChinhThuc</span> Bác sĩ chính trong bệnh viện</p>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-xl-4 col-sm-6">
                <div class="card p-3 shadow-2 radius-8 h-100 bg-gradient-end-4">
                    <div class="card-body p-0">
                        <div class="d-flex flex-wrap align-items-center justify-content-between gap-1 mb-8">

                            <div class="d-flex align-items-center gap-2">
                                <span class="mb-0 w-48-px h-48-px bg-lilac-100 text-lilac-600 flex-shrink-0 text-white d-flex justify-content-center align-items-center rounded-circle h6 mb-0">
                                    <i class="ri-award-fill"></i>
                                </span>
                                <div>
                                    <h6 class="fw-semibold mb-2">@Model.soLuongChart.NhanVienTheoMa</h6>
                                    <span class="fw-medium text-secondary-light text-sm">Nhân viên y tế trong bệnh viện</span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm mb-0"> <span class="text-lilac-600">@Model.soLuongChart.YTaChinhThuc</span> Y tá theo dõi sức khỏe</p>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-xl-4 col-sm-6">
                <div class="card p-3 shadow-2 radius-8 h-100 bg-gradient-end-1">
                    <div class="card-body p-0">
                        <div class="d-flex flex-wrap align-items-center justify-content-between gap-1 mb-8">

                            <div class="d-flex align-items-center gap-2">
                                <span class="mb-0 w-48-px h-48-px bg-primary-100 text-primary-600 flex-shrink-0 text-white d-flex justify-content-center align-items-center rounded-circle h6 mb-0">
                                    <i class="ri-group-fill"></i>
                                </span>
                                <div>
                                    <h6 class="fw-semibold mb-2">@Model.soLuongChart.benhnhan</h6>
                                    <span class="fw-medium text-secondary-light text-sm">Bệnh nhân đăng ký khám trực tiếp</span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm mb-0"> <span class="text-primary-600">@Model.soLuongChart.benhnhanmonth </span> Bệnh nhân đăng ký khám trực tiếp trong tháng này</p>
                    </div>
                </div>
            </div>
            <div class="col-xxl-3 col-xl-4 col-sm-6">
                <div class="card p-3 shadow-2 radius-8 h-100 bg-gradient-end-1">
                    <div class="card-body p-0">
                        <div class="d-flex flex-wrap align-items-center justify-content-between gap-1 mb-8">

                            <div class="d-flex align-items-center gap-2">
                                <span class="mb-0 w-48-px h-48-px bg-success-100 text-success-600 flex-shrink-0 text-white d-flex justify-content-center align-items-center rounded-circle h6 mb-0">
                                    <i class="ri-wallet-3-fill"></i>
                                </span>
                                <div>
                                    <h6 class="fw-semibold mb-2">@Model.soLuongChart.benhnhan2</h6>
                                    <span class="fw-medium text-secondary-light text-sm">Bệnh nhân đăng ký khám online </span>
                                </div>
                            </div>
                        </div>
                        <p class="text-sm mb-0"> <span class="text-success-600">@Model.soLuongChart.benhnhan2month </span> Bệnh nhân đăng ký khám online tháng này</p>
                    </div>
                </div>
            </div>


            <!-- Earning Statistic -->
            <div class="col-xxl-12">
                <div class="card h-100">
                    <div class="card-header">
                        <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                            <h6 class="mb-2 fw-bold text-lg mb-0">Biểu đồ bệnh nhân đăng ký khám</h6>
                            
                         <form asp-controller="ThongKe_ThuNguyet" asp-action="Dashboard" method="get">
    <label for="year">Chọn năm:</label>
    <select name="year" id="year" onchange="this.form.submit()">
        <option value="">-- Chọn năm --</option>
       @for (int y = 2022; y <= 2025; y++)
{
    var isSelected = ViewBag.SelectedYear != null && ViewBag.SelectedYear == y ? "selected" : "";
    @:<option value="@y" @isSelected>Năm @y</option>
}

    </select>

    <label for="month">Chọn tháng:</label>
    <select name="month" id="month" onchange="this.form.submit()">
        <option value="">-- Chọn tháng --</option>
        @for (int m = 1; m <= 12; m++)
{
    var isSelected = ViewBag.SelectedMonth != null && ViewBag.SelectedMonth == m ? "selected" : "";
    @:<option value="@m" @isSelected>Tháng @m</option>
}
    </select>
</form>


                        </div>
                    </div>
                    <div class="card-body p-24">
                        <ul class="d-flex flex-wrap align-items-center justify-content-center my-3 gap-3">
                            <li class="d-flex align-items-center gap-2">
                                <span class="w-12-px h-8-px rounded-pill bg-primary-600"></span>
                                <span class="text-secondary-light text-sm fw-semibold">
                                    Bệnh nhân đến ĐK khám trực tiếp
                                </span>
                            </li>
                            <li class="d-flex align-items-center gap-2">
                                <span class="w-12-px h-8-px rounded-pill bg-warning-600"></span>
                                <span class="text-secondary-light text-sm fw-semibold">
                                    Bệnh nhân đăng ký online
                                </span>
                            </li>
                        </ul>
                        <div id="enrollmentChart" class="apexcharts-tooltip-style-1"></div>
                    </div>
                </div>
            </div>
            <!-- Earning Statistic -->

            <!-- Patient Visited by Depertment -->
            <div class="col-xxl-6">
                <div class="card h-100">
                    <div class="card-header">
                        <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                            <h6 class="mb-2 fw-bold text-lg mb-0">Top 3 khoa có số bệnh nhân khám nhiều nhất</h6>
                        </div>
                    </div>
                    <div class="card-body p-24 d-flex align-items-center gap-16">
                        <div id="radialMultipleBar"></div>
                        <ul class="d-flex flex-column gap-12">
                            <ul class="d-flex flex-column gap-12">
                                @foreach (var item in Model.CircleChart)
                                {
                                    <li>
                                        <span class="text-lg">
                                            @item.TenKhoa: <span class="text-primary-600 fw-semibold">@item.SoBenhNhan%</span>
                                        </span>
                                    </li>
                                }
                            </ul>

                           
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Patient Visited by Depertment -->
           
            <!-- Patient Visit By Gender -->
            <div class="col-xxl-6">
                <div class="card h-100">
                    <div class="card-header">
                        <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                            <h6 class="mb-2 fw-bold text-lg mb-0">Thống kê bệnh nhân nội trú và ngoại trú</h6>
                            <select class="form-select form-select-sm w-auto bg-base border-0 text-secondary-light">
                                <option>This Month</option>
                                <option>This Week</option>
                                <option>This Year</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body p-24">
                        <ul class="d-flex flex-wrap align-items-center justify-content-center my-3 gap-3">
                            <li class="d-flex align-items-center gap-2">
                                <span class="w-12-px h-8-px rounded-pill bg-warning-600"></span>
                                <span class="text-secondary-light text-sm fw-semibold">
                                    Ngoại trú
                                </span>
                            </li>
                            <li class="d-flex align-items-center gap-2">
                                <span class="w-12-px h-8-px rounded-pill bg-success-600"></span>
                                <span class="text-secondary-light text-sm fw-semibold">
                                    Nội trú
                                </span>
                            </li>
                        </ul>
                        <div id="paymentStatusChart" class="margin-16-minus y-value-left"></div>
                    </div>
                </div>
            </div>
            <!-- Patient Visit By Gender -->
           
            <!-- Top performance Start -->
            <div class="col-xxl-4">
                <div class="card h-100">
            <div class="card-body p-24">
                <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                    <h6 class="mb-2 fw-bold text-lg">Chẩn đoán</h6>
                    
                </div>

                <div class="mt-32">
                    <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                        <div class="d-flex align-items-center gap-3">
                            <div class="w-40-px h-40-px rounded-circle d-flex justify-content-center align-items-center bg-success-200 flex-shrink-0">
                                <img src="{{ asset('assets/images/home-nine/payment1.png') }}" alt="" class="">
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="text-md mb-0 fw-normal">Chuyển viện</h6>
                                <span class="text-sm text-secondary-light fw-normal">Số bệnh nhân chuyển đến từ bệnh viện khác</span>
                            </div>
                        </div>
                        <span class="text-secondary-light text-md fw-medium">@Model.chanDoanChart.SoLuongChuyenVien</span>
                    </div>
                    <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                        <div class="d-flex align-items-center gap-3">
                            <div class="w-40-px h-40-px rounded-circle d-flex justify-content-center align-items-center bg-info-200 flex-shrink-0">
                                <img src="{{ asset('assets/images/home-nine/payment2.png') }}" alt="" class="">
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="text-md mb-0 fw-normal">Cấp cứu</h6>
                                <span class="text-sm text-secondary-light fw-normal">Số bệnh nhân cấp cứu</span>
                            </div>
                        </div>
                        <span class="text-secondary-light text-md fw-medium">@Model.chanDoanChart.SoLuongCapCuu</span>
                    </div>
                    <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                        <div class="d-flex align-items-center gap-3">
                            <div class="w-40-px h-40-px rounded-circle d-flex justify-content-center align-items-center bg-warning-200 flex-shrink-0">
                                <img src="{{ asset('assets/images/home-nine/payment3.png') }}" alt="" class="">
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="text-md mb-0 fw-normal">Phẫu thuật </h6>
                                <span class="text-sm text-secondary-light fw-normal">Số bệnh nhân làm phẫu thuật</span>
                            </div>
                        </div>
                        <span class="text-secondary-light text-md fw-medium">@Model.chanDoanChart.SoLuongPhauThuat</span>
                    </div>
                    <div class="d-flex align-items-center justify-content-between gap-3 mb-0">
                        <div class="d-flex align-items-center gap-3">
                            <div class="w-40-px h-40-px rounded-circle d-flex justify-content-center align-items-center bg-lilac-200 flex-shrink-0">
                                <img src="{{ asset('assets/images/home-nine/payment4.png') }}" alt="" class="">
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="text-md mb-0 fw-normal">Tái khám</h6>
                                <span class="text-sm text-secondary-light fw-normal">Số bệnh nhân cần tái khám</span>
                            </div>
                        </div>
                        <span class="text-secondary-light text-md fw-medium">@Model.chanDoanChart.SoLuongTaiKham</span>
                    </div>
                </div>

            </div>
        </div>
    </div>
            <!-- Top performance End -->

            <div class="col-xxl-8">
                <div class="card h-100">
                    <div class="card-header border-bottom bg-base py-16 px-24 d-flex align-items-center justify-content-between">
                        <h6 class="text-lg fw-semibold mb-0">Bệnh nhân tái khám</h6>
                        <div class="d-flex align-items-center gap-3">
                            <select id="statusFilter" class="form-select form-select-sm" style="width: 160px;">
                                <option value="all">Tất cả</option>
                                <option value="done">Hoàn thành</option>
                                <option value="pending">Chưa tái khám</option>
                            </select>

                        </div>
                        </div>   
                       
                    <div class="card-body p-0">
                        <div class="table-responsive scroll-sm" style="overflow-x: auto; max-height: 400px;">
                            <table class="table bordered-table mb-0 rounded-0 border-0">
                                <thead>
                                    <tr>
                                        <th scope="col" class="bg-transparent rounded-0">Tên Bệnh Nhân</th>
                                        <th scope="col" class="bg-transparent rounded-0">Mã HSBA</th>
                                        <th scope="col" class="bg-transparent rounded-0">Ngày Tái Khám</th>
                                        <th scope="col" class="bg-transparent rounded-0">Tình Trạng</th>
                                    </tr>
                                </thead>
                                    <tbody id="appointmentTable">
                                    @foreach (var item in Model.taiKhamChart)  // Model là danh sách trả về từ controller
                                    {
                                        <tr>
                                            <td>@item.TenBenhNhan</td>
                                            <td>@item.MaHSBA</td>
                                            <td>@item.tgTaiKham.ToString("dd/MM/yyyy")</td>
                                            <td>
                                                @if (item.TrangThai == "Đã tái khám") // Đã tái khám
                                                {
                                                    <span class="bg-success-focus text-success-main px-10 py-4 radius-8 fw-medium text-sm">Hoàn thành</span>
                                                }
                                                else // Chưa tái khám
                                                {
                                                    <span class="bg-danger-focus text-danger-main px-10 py-4 radius-8 fw-medium text-sm">Chưa tái khám</span>
                                                }
                                            </td>
                                        </tr>
                                    }

                                  
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Latest Performance End -->
        </div>
    </div>
   
    <div class="col-xxxl-3">
        <div class="row gy-4">
            <div class="col-xxl-12 col-xl-6">
                <div class="card h-100 radius-8 border-0">
                    <div class="card-header border-bottom d-flex align-items-center flex-wrap gap-2 justify-content-between">
                        <h6 class="mb-2 fw-bold text-lg">Tổng HSBA</h6>
                        <div class="">
                            <select class="form-select form-select-sm w-auto bg-base border-0 text-secondary-light">
                                <option>Tháng này</option>
                                <option>Năm này</option>
                                <option>Tuần này</option>
                            </select>
                        </div>
                    </div>
                    <div class="card-body p-24">

                        <div class="position-relative">
                            <div id="statisticsDonutChart" class="mt-36 flex-grow-1 apexcharts-tooltip-z-none title-style circle-none"></div>
                            <div class="text-center position-absolute top-50 start-50 translate-middle">
                                <span class="text-secondary-light">Tổng HSBA</span>
                            </div>
                        </div>
                      
                        <ul class="row gy-4 mt-3">
                            <li class="col-6 d-flex flex-column align-items-center">
                                <div class="d-flex align-items-center gap-2">
                                    <span class="w-12-px h-8-px rounded-pill bg-warning-600"></span>
                                    <span class="text-secondary-light text-sm fw-normal">Đã xong</span>
                                </div>
                            </li>
                            <li class="col-6 d-flex flex-column align-items-center">
                                <div class="d-flex align-items-center gap-2">
                                    <span class="w-12-px h-8-px rounded-pill bg-success-600"></span>
                                    <span class="text-secondary-light text-sm fw-normal">Đang điều trị </span>
                                </div>
                            </li>
                        </ul>

                    </div>
                </div>
            </div>


            <div class="col-xxl-12 col-sm-6">
                    <div class="card h-100 radius-8 border-0">
                        <div class="card-body p-24">
                            <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                                <h6 class="mb-2 fw-bold text-lg">Xét nghiệm</h6>
                                <div class="">
                                    <select class="form-select form-select-sm w-auto bg-base border text-secondary-light">
                                        <option>Tuần này</option>
                                        <option>Tháng này</option>
                                        <option>Năm này</option>
                                        <option>Hôm nay</option>
                                    </select>
                                </div>
                            </div>

                            <div class="mt-3">
                           
                                <div class="d-flex align-items-center justify-content-between gap-3 mb-12">
                                    <div class="d-flex align-items-center">
                                        <span class="text-xxl line-height-1 d-flex align-content-center flex-shrink-0 text-orange">
                                            <iconify-icon icon="majesticons:mail" class="icon"></iconify-icon>
                                        </span>
                                        <span class="text-primary-light fw-medium text-sm ps-12">@Model.xetNghiemChart[0].LoaiXN</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2 w-100">
                                        <div class="w-100 max-w-66 ms-auto">
                                            <div class="progress progress-sm rounded-pill" role="progressbar" aria-label="Success example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                                <div class="progress-bar bg-orange rounded-pill" style="width: 80%;"></div>
                                            </div>
                                        </div>
                                        <span class="text-secondary-light font-xs fw-semibold">@Model.xetNghiemChart[0].soBN</span>
                                    </div>
                                </div>

                                <div class="d-flex align-items-center justify-content-between gap-3 mb-12">
                                    <div class="d-flex align-items-center">
                                        <span class="text-xxl line-height-1 d-flex align-content-center flex-shrink-0 text-success-main">
                                            <iconify-icon icon="eva:globe-2-fill" class="icon"></iconify-icon>
                                        </span>
                                    <span class="text-primary-light fw-medium text-sm ps-12">@Model.xetNghiemChart[1].LoaiXN</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2 w-100">
                                        <div class="w-100 max-w-66 ms-auto">
                                            <div class="progress progress-sm rounded-pill" role="progressbar" aria-label="Success example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                                <div class="progress-bar bg-success-main rounded-pill" style="width: 80%;"></div>
                                            </div>
                                        </div>
                                    <span class="text-secondary-light font-xs fw-semibold">@Model.xetNghiemChart[1].soBN</span>
                                    </div>
                                </div>

                                <div class="d-flex align-items-center justify-content-between gap-3 mb-12">
                                    <div class="d-flex align-items-center">
                                        <span class="text-xxl line-height-1 d-flex align-content-center flex-shrink-0 text-info-main">
                                            <iconify-icon icon="fa6-brands:square-facebook" class="icon"></iconify-icon>
                                        </span>
                                    <span class="text-primary-light fw-medium text-sm ps-12">@Model.xetNghiemChart[2].LoaiXN</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2 w-100">
                                        <div class="w-100 max-w-66 ms-auto">
                                            <div class="progress progress-sm rounded-pill" role="progressbar" aria-label="Success example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                                <div class="progress-bar bg-info-main rounded-pill" style="width: 80%;"></div>
                                            </div>
                                        </div>
                                    <span class="text-secondary-light font-xs fw-semibold">@Model.xetNghiemChart[2].soBN</span>
                                    </div>
                                </div>

                                <div class="d-flex align-items-center justify-content-between gap-3">
                                    <div class="d-flex align-items-center">
                                        <span class="text-xxl line-height-1 d-flex align-content-center flex-shrink-0 text-indigo">
                                            <iconify-icon icon="fluent:location-off-20-filled" class="icon"></iconify-icon>
                                        </span>
                                    <span class="text-primary-light fw-medium text-sm ps-12">@Model.xetNghiemChart[3].LoaiXN</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2 w-100">
                                        <div class="w-100 max-w-66 ms-auto">
                                            <div class="progress progress-sm rounded-pill" role="progressbar" aria-label="Success example" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                                <div class="progress-bar bg-indigo rounded-pill" style="width: 75%;"></div>
                                            </div>
                                        </div>
                                    <span class="text-secondary-light font-xs fw-semibold">@Model.xetNghiemChart[3].soBN</span>
                                    </div>
                                </div>
                            
                              

                            </div>

                        </div>
                    </div>
                </div>
               

            <div class="col-xxl-12 col-xl-6">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex align-items-center flex-wrap gap-2 justify-content-between">
                            <h6 class="mb-2 fw-bold text-lg mb-0">Các khoa nổi bật</h6>
                            <a href="javascript:void(0)" class="text-primary-600 hover-text-primary d-flex align-items-center gap-1">
                                View All
                                <iconify-icon icon="solar:alt-arrow-right-linear" class="icon"></iconify-icon>
                            </a>
                        </div>
                    </div>
                    <div class="card-body">
                      
                            <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                                <div class="d-flex align-items-center gap-12">
                                    <div class="w-40-px h-40-px rounded-circle flex-shrink-0 bg-info-50 d-flex justify-content-center align-items-center">
                                        <img src="~/images/home-eight/treatment-icon1.png" alt="" class="">
                                    </div>
                                    <div class="flex-grow-1">
                                        <h6 class="text-md mb-0 fw-normal">@Model.nhansu[0].TenKhoa</h6>
                                        <span class="text-sm text-secondary-light fw-normal">@Model.nhansu[0].SoLuongBacSi Bác sĩ và @Model.nhansu[0].SoLuongNhanVien Nhân viên</span>
                                    </div>
                                </div>
                            </div>
                       
                        <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                            <div class="d-flex align-items-center gap-12">
                                <div class="w-40-px h-40-px rounded-circle flex-shrink-0 bg-lilac-50 d-flex justify-content-center align-items-center">
                                    <img src="~/images/home-eight/treatment-icon3.png" alt="" class="">
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="text-md mb-0 fw-normal">@Model.nhansu[1].TenKhoa</h6>
                                    <span class="text-sm text-secondary-light fw-normal">@Model.nhansu[1].SoLuongBacSi Bác sĩ và @Model.nhansu[1].SoLuongNhanVien Nhân viên</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                            <div class="d-flex align-items-center gap-12">
                                <div class="w-40-px h-40-px rounded-circle flex-shrink-0 bg-warning-50 d-flex justify-content-center align-items-center">
                                    <img src="~/images/home-eight/treatment-icon4.png" alt="" class="">
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="text-md mb-0 fw-normal">@Model.nhansu[2].TenKhoa</h6>
                                    <span class="text-sm text-secondary-light fw-normal">@Model.nhansu[2].SoLuongBacSi Bác sĩ và @Model.nhansu[2].SoLuongNhanVien Nhân viên</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center justify-content-between gap-3 mb-24">
                            <div class="d-flex align-items-center gap-12">
                                <div class="w-40-px h-40-px rounded-circle flex-shrink-0 bg-danger-50 d-flex justify-content-center align-items-center">
                                    <img src="~/images/home-eight/treatment-icon5.png" alt="" class="">
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="text-md mb-0 fw-normal">@Model.nhansu[3].TenKhoa </h6>
                                    <span class="text-sm text-secondary-light fw-normal">@Model.nhansu[3].SoLuongBacSi Bác sĩ và @Model.nhansu[3].SoLuongNhanVien Nhân viên</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center justify-content-between gap-3 mb-0">
                            <div class="d-flex align-items-center gap-12">
                                <div class="w-40-px h-40-px rounded-circle flex-shrink-0 bg-primary-50 d-flex justify-content-center align-items-center">
                                    <img src="~/images/home-eight/treatment-icon6.png" alt="" class="">
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="text-md mb-0 fw-normal">@Model.nhansu[4].TenKhoa</h6>
                                    <span class="text-sm text-secondary-light fw-normal">@Model.nhansu[4].SoLuongBacSi Bác sĩ và @Model.nhansu[4].SoLuongNhanVien Nhân viên</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
          
        </div>
    </div>
</div>

    <script>
        document.getElementById("statusFilter").addEventListener("change", function () {
            var selected = this.value;
            var rows = document.querySelectorAll("#appointmentTable tr");

            rows.forEach(function (row) {
                var statusCell = row.querySelector("td:last-child span");
                var statusText = statusCell ? statusCell.textContent.trim() : "";

                // Logic lọc
                if (selected === "all") {
                    row.style.display = "";
                } else if (selected === "done" && statusText === "Hoàn thành") {
                    row.style.display = "";
                } else if (selected === "pending" && statusText === "Chưa tái khám") {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        });
    </script>
